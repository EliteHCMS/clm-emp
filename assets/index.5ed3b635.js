import{a$ as K,I as Q,J as T,aq as M,q as y,K as V,l as L,r as v,w as j,_ as A,p as c,t as g,v as i,P as w,M as l,d as o,Q as d,L as C,W as S,R as b,N as h,F as U,$ as Y,b0 as B,O as Z,b1 as H,o as J,c as W,y as N,S as tt,X as et,aZ as st,aA as O,ar as at,Z as X,a1 as ot}from"./index.979edcb2.js";const nt=25,F=K("assessment",{state:()=>({step:0,loading:!0,tools:[],testData:{allQuestions:[],selectedQuestions:[],completedQuestions:[],nextQuestions:null,testStatus:"In Progress",currentScope:0,loadIteration:0,qb:{testRecord:{3:{field:"Record ID#",value:24712},6:{field:"Related Kiosk Profile"},13:{field:"Related Hiring Center"},15:{field:"Related Employee"},17:{field:"Related Craft"},23:{field:"Related Available Language"},34:{field:"Test Completion Timestamp"},37:{field:"Test Status"},testQuestions:[{6:{field:"Related Test"},7:{field:"Related All Test Question"},11:{field:"Status"},questionResponse:[{6:{field:"Related Test Question"},8:{field:"Related Question Alternative"}}]}]}}},testId:null,qb:null,questions:[],answers:[],toolListId:null}),getters:{questionsLoaded(){return this.testData.allQuestions.length>0},nextQuestions(){return this.testData.nextQuestions?this.testData.nextQuestions:null},completedOnIteration(){return this.testData.completedQuestions.filter(t=>t.iteration===this.testData.loadIteration)},algo(){const t=this.testData.completedQuestions.filter(s=>s.selection[14]===1&&s.iteration===this.testData.loadIteration);return t!==void 0?t:[]},ratio(){return isNaN(this.algo.length/this.completedOnIteration.length)?0:(this.algo.length/this.completedOnIteration.length).toFixed(2)},nextScope(){return this.completedOnIteration.length>0?this.ratio>.6?this.testData.currentScope<6?this.testData.currentScope+1:this.testData.currentScope:this.ratio===.6?this.testData.currentScope:this.testData.currentScope>2?this.testData.currentScope-1:this.testData.currentScope:this.testData.currentScope},nextIteration(){return this.testData.loadIteration+1},timeToStop(){const t=this.testData.completedQuestions.filter(e=>e[23]>this.testData.currentScope).length,s=this.testData.completedQuestions.filter(e=>e[23]<this.testData.currentScope).length;return t>0&&s>0&&this.testData.completedQuestions.length>=nt},toolChecklistData(){const{hiringCenter:t,testForCraft:s}=Q(),{employeeData:e}=T(),a={6:{value:this.testId?this.testId:0},11:{value:t[3]?t[3].value:0},15:{value:e[3]?e[3]:0},20:{value:s[15]?s[15]:0},22:{value:s[16]?s[16]:0}};return{to:"bp3gcpk2w",data:[a],fieldsToReturn:[3]}},toolsData(){const t=[];return this.tools.length>0&&this.tools.forEach(s=>{const e={6:{value:this.toolListId?this.toolListId:0},7:{value:s.value}};t.push(e)}),{to:"bp928wac2",data:t,fieldsToReturn:[3]}}},actions:{async startAssessment(){const{profile:t}=M(),{hiringCenter:s,testForCraft:e}=Q(),{employeeData:a}=T(),r=[{6:{value:t[3].value},13:{value:s[3].value},15:{value:a[3]},17:{value:e[15]},23:{value:e[16]},51:{value:e[3]}}],{data:n}=await y.upsertRecordsXML({to:"bp3gckirf",data:r,fieldsToReturn:[3]});if(n[0])return this.testId=n[0][3],n[0];throw"Something went wrong"},async finishAssessment(){const{metadata:t}=await y.upsertRecordsXML({to:"bp3gckirf",data:[{3:{value:this.testId},34:{value:new Date},37:{value:"Complete"}}],mergeFieldId:3});if(t.updatedRecordIds[0]){const{data:s}=await y.upsertRecordsXML({to:"bp9np6ckn",data:this.questions,fieldsToReturn:[3,7]});if(!s.length>0)throw"Cannot save questions";{const e=[];s.forEach(r=>{const n=this.answers.findIndex(u=>u.link===r[7]);if(n>-1){const u={6:{value:r[3]},8:{value:this.answers[n][8]}};e.push(u)}});const{metadata:a}=await y.upsertRecordsXML({to:"bp9np9vk7",data:e});if(!a.createdRecordIds.length===this.answers.length)throw"Something went wrong";return{success:!0}}}else throw"Cannot finish assessment"},async startToolChecklist(){const{data:t}=await y.upsertRecordsXML(this.toolChecklistData);if(t[0])return this.toolListId=t[0][3],t[0];throw"Cannot start checklist"},async finishToolChecklist(){const{metadata:t}=await y.upsertRecordsXML({to:"bp3gcpk2w",data:[{3:{value:this.toolListId},18:{value:new Date},17:{value:"Complete"}}],mergeFieldId:3});if(t.updatedRecordIds[0]){const{data:s}=await y.upsertRecordsXML(this.toolsData);if(s.length>0)return!0;throw"Cannot save tools"}else throw"Cannot finish tool checklist"},async submitToQB(){const{profile:t}=M(),{hiringCenter:s,testForCraft:e}=Q(),{devEmployee:a}=T();this.testData.qb.testRecord[6].value=t[3].value,this.testData.qb.testRecord[13].value=s[3].value,this.testData.qb.testRecord[15].value=a[3],this.testData.qb.testRecord[17].value=e[15],this.testData.qb.testRecord[23].value=e[16],this.testData.qb.testRecord[34].value=Date.now(),this.testData.qb.testRecord[37].value="Complete";const r=[];return this.testData.completedQuestions.forEach(n=>{const u={6:{value:this.testData.qb.testRecord[3].value},7:{value:n[8]},11:{value:"Complete"},questionResponse:[{6:{value:0},8:{value:n.selection[3]}}]};r.push(u)}),this.testData.qb.testRecord.testQuestions=r,this.testData.qb.testRecord},async updateAssessment(t){return this.step=t.next,t.type==="tools"&&(this.tools=t.values),!0},updateStep(t){this.step=t},dataLoaded(){this.loading=!1},async getAllQuestions(){const{testForCraft:t}=Q();if(this.questionsLoaded)return!0;if(t){const{data:s}=await y.doQuery({from:"bqamed7sr",where:`{'6'.EX.'${t[9]}'}`,select:[3,6,8,9,10,11,12,13,14,18,19,20,21,22,23,24],sortBy:[{fieldId:11,order:"ASC"}]});if(s)return s.forEach(async e=>{e[20]==="Yes"&&(e.hasImage=!0,e.imageData={src:e[22],alt:e[21]}),e[19]=await V.converter(e[19]),e[24]=await V.converter(e[24]),e[19].forEach(a=>{a.value=a[3],a.label=a[6]})}),this.testData.allQuestions=s,!0;throw"Something went wrong"}else throw"No test for craft"},async loadQuestionGroup(t,s){if(t!==void 0){const e=this.testData.allQuestions.filter(a=>a[23]===t);if(e.length>0)return e.length>5&&(e.length=5),e.forEach(a=>{a.response=null;const r=this.testData.allQuestions.findIndex(n=>n[3]===a[3]);r>-1&&this.testData.allQuestions.splice(r,1)}),this.testData.nextQuestions=e,this.testData.currentScope=t,this.testData.loadIteration=s,e;throw"There are no questions"}},async completeQuestion(t){const s=t.response,e=t[19].find(n=>n.value===s);if(e!==void 0)t.selection=e;else throw"No selection";t.iteration=this.testData.loadIteration,t.storedData={};const a={6:{value:this.testId},7:{value:t[8]},11:{value:"Complete"}};this.questions.push(a);const r={6:null,8:t.selection[3],link:t[8]};return this.answers.push(r),this.testData.completedQuestions.push(t),this.testData.nextQuestions=this.testData.nextQuestions.filter(n=>n[3]!==t[3]),{data:{nextQuestions:this.timeToStop?[]:this.testData.nextQuestions,scope:this.nextScope,iteration:this.nextIteration}}}}}),lt=L({components:{},setup(){const{toolsForCraft:t,toolListInstructions:s}=Q(),{updateAssessment:e,startToolChecklist:a,finishToolChecklist:r}=F(),n=v([]),u=v(0);async function _(){await a(),u.value=1}async function q(){await e({next:1,type:"tools",values:n.value});const f=await r();console.log(f)}function k(f,D){console.log(f)}return j(n,(f,D)=>{console.log(f)}),{toolsForCraft:t,save:q,pushItem:k,selected:n,step:u,updateAssessment:e,toolListInstructions:s,start:_}}}),it={class:"row justify-center"},rt={class:"col-12 col-md-10 q-pt-sm"},ut=i("div",{class:"text-h6 text-primary"},"Scaffold Tool Assessment",-1),ct={class:"text-body1 text-dark"},dt=i("div",{class:"text-h6 text-dark"}," Tool Assessment ",-1),ht=i("div",{class:"text-body1 text-secondary text-italic"}," Please select the tools you own from the following list. ",-1),pt={class:"row justify-center"},ft={class:"row items-center"},mt={class:"col-11"},vt={class:"text-body1 text-primary"},gt={class:"col-1"},wt={class:"row q-pt-md"},yt={class:"col-12 text-right"};function _t(t,s,e,a,r,n){return c(),g("div",null,[i("div",it,[i("div",rt,[t.step===0?(c(),w(b,{key:0,class:"q-mt-xl"},{default:l(()=>[o(d,null,{default:l(()=>[ut]),_:1}),o(d,null,{default:l(()=>[i("div",ct,C(t.toolListInstructions),1)]),_:1}),o(d,{class:"text-right"},{default:l(()=>[o(S,{color:"primary",label:"Continue",onClick:t.start},null,8,["onClick"])]),_:1})]),_:1})):h("",!0),t.step===1?(c(),w(b,{key:1,flat:""},{default:l(()=>[o(d,null,{default:l(()=>[dt,ht]),_:1}),o(d,null,{default:l(()=>[i("div",pt,[(c(!0),g(U,null,Y(t.toolsForCraft,u=>(c(),g("div",{class:"col-12 col-md-6",key:u[3]},[o(b,{class:"tool-card q-ma-sm"},{default:l(()=>[o(d,null,{default:l(()=>[o(B,{style:{"max-height":"150px"},fit:"scale-down",src:u[11]},null,8,["src"])]),_:2},1024),o(Z),o(d,null,{default:l(()=>[i("div",ft,[i("div",mt,[i("div",vt,C(u[8]),1)]),i("div",gt,[o(H,{modelValue:t.selected,"onUpdate:modelValue":s[0]||(s[0]=_=>t.selected=_),color:"primary",val:u.value},null,8,["modelValue","val"])])])]),_:2},1024)]),_:2},1024)]))),128))]),i("div",wt,[i("div",yt,[o(S,{color:"primary",onClick:t.save,label:"Continue"},null,8,["onClick"])])])]),_:1})]),_:1})):h("",!0)])])])}var Dt=A(lt,[["render",_t]]);const Qt=L({components:{},setup(){const t=v(0),{testForCraft:s,startLevelForTest:e}=Q(),{getAllQuestions:a,questionsLoaded:r,loadQuestionGroup:n,completeQuestion:u,startAssessment:_,finishAssessment:q,updateAssessment:k}=F(),f=v(!0),D=v(null),I=v(null),m=v([]),E=v(!1),R=v(!1);J(async()=>{r||await a(),f.value=!1,m.value=await n(e[14],1)});const $=W(()=>{const p=m.value?m.value.length:0,x=Math.floor(Math.random()*(p-0));return m.value&&m.value.length>0?m.value[x]:null});j(D,(p,x)=>{p&&(I.value=null)});async function P(){if(!D.value)I.value="Select an answer";else{R.value=!0,I.value=null,$.value.response=D.value;const{data:p}=await u($.value);if(D.value=null,p.nextQuestions.length>0)m.value=p.nextQuestions,R.value=!1;else try{m.value=await n(p.scope,p.iteration),R.value=!1}catch{m.value=[];const{success:G}=await q();G&&s[18]==="Yes"?k({next:1}):k({next:10})}}}async function z(){E.value=!0;try{await _(),t.value=1}catch(p){console.log(p)}}return{step:t,testForCraft:s,loading:f,currentQuestion:$,response:D,responseError:I,submit:P,launchAssessment:z,starting:E,submitting:R}}}),bt={key:0,class:"row justify-center"},Ct={class:"col-12 col-md-10 q-pt-sm"},kt={class:"text-h6 text-primary"},It={class:"text-body1 text-dark"},Rt={class:"text-h5 text-primary"},St={class:"q-pa-sm"},qt={class:"text-body1"},$t=i("hr",null,null,-1),xt={key:0,class:"col-5"},Tt={key:1,class:"absolute-center"};function Lt(t,s,e,a,r,n){return c(),g("div",null,[t.loading?h("",!0):(c(),g("div",bt,[i("div",Ct,[t.step===0?(c(),w(b,{key:0,class:"q-mt-xl"},{default:l(()=>[o(d,null,{default:l(()=>[i("div",kt,C(t.testForCraft[29]),1)]),_:1}),o(d,null,{default:l(()=>[i("div",It,C(t.testForCraft[28]),1)]),_:1}),o(d,{class:"text-right"},{default:l(()=>[o(S,{color:"primary",label:"Continue",onClick:t.launchAssessment,loading:t.starting,disabled:t.starting},null,8,["onClick","loading","disabled"])]),_:1})]),_:1})):h("",!0),t.step===1?(c(),w(b,{key:1,flat:""},{default:l(()=>[o(d,null,{default:l(()=>[i("div",Rt,C(t.testForCraft[29]),1)]),_:1}),t.currentQuestion?(c(),w(d,{key:0},{default:l(()=>[o(b,{flat:""},{default:l(()=>[o(d,null,{default:l(()=>[i("div",{class:N(t.currentQuestion.hasImage?"row justify-between items-start":"row justify-center items-start")},[i("div",{class:N(t.currentQuestion.hasImage?"col-6":"col-10")},[o(b,null,{default:l(()=>[o(d,null,{default:l(()=>[i("div",St,[i("div",qt,[tt(C(t.currentQuestion[9])+" ",1),t.responseError?(c(),w(et,{key:0,size:"md",class:"q-ml-sm",name:"error",color:"red"})):h("",!0)]),o(st,{options:t.currentQuestion[19],type:"radio",modelValue:t.response,"onUpdate:modelValue":s[0]||(s[0]=u=>t.response=u)},null,8,["options","modelValue"])])]),_:1}),$t,o(d,{class:"text-right"},{default:l(()=>[o(S,{color:"primary",label:"Submit",onClick:t.submit,loading:t.submitting,disabled:t.submitting},null,8,["onClick","loading","disabled"])]),_:1})]),_:1})],2),t.currentQuestion.hasImage?(c(),g("div",xt,[o(B,{class:"question-img",fit:"scale-down",src:t.currentQuestion.imageData.src,alt:t.currentQuestion.imageData.alt},null,8,["src","alt"])])):h("",!0)],2)]),_:1})]),_:1})]),_:1})):h("",!0)]),_:1})):h("",!0)])])),t.loading?(c(),g("div",Tt,[o(O,{color:"primary",size:"5em"})])):h("",!0)])}var At=A(Qt,[["render",Lt]]);const Ft=L({components:{tools:Dt,test:At},setup(){const t=F(),{step:s,loading:e}=at(t),{getFormOptions:a}=Q();return a(),{step:s,loading:e}}}),Et={key:0,class:"row"},Mt={class:"col"},Vt={key:1,class:"absolute-center"};function Nt(t,s,e,a,r,n){const u=X("tools"),_=X("test");return c(),w(ot,{class:"window-height window-width"},{default:l(()=>[t.loading?h("",!0):(c(),g("div",Et,[i("div",Mt,[t.step===1?(c(),w(u,{key:0})):h("",!0),t.step===0?(c(),w(_,{key:1})):h("",!0)])])),t.loading?(c(),g("div",Vt,[o(O,{color:"primary",size:"5em"})])):h("",!0)]),_:1})}var jt=A(Ft,[["render",Nt]]);export{jt as default};
