import{r as m,c as k,u as B,ad as M,ae as t,d as s,a_ as c,a$ as q,b0 as l,b as _,ag as g,b1 as R,au as U,b2 as E,B as L,b3 as P,b4 as S,b5 as $,y as F}from"./index.783c3705.js";import{u as N}from"./use-quasar.ef99e846.js";import{c as x,u as h}from"./array.2d486e63.js";import{b as D,q as Q}from"./quickbase.f6d2e685.js";const I=F("div",{class:"text-h6"},"Hiring Center Kiosk Login",-1),J={__name:"KioskLogin",setup(X){const{screen:n,notify:u}=N(),{setKioskAccount:V}=D(),d=m(!0),v=m(null),i=m(!1),A=k(()=>x().email().required().nullable()),K=k(()=>x().required().nullable()),{errorMessage:f,value:r}=h("email",A),{errorMessage:b,value:o}=h("password",K),y=async()=>{if(r.value===""||o.value===""||!r.value||!o.value){u({type:"negative",message:"Email and password Required!",timeout:7e3,position:n.lt.md?"top":"top-right"});return}i.value=!0;const p={email:r.value,password:o.value};try{const a=`{'11'.EX.'${(await Q.nativeQuickbaseLogin(p)).email}'}AND{'6'.EX.'Active'}`,C=[{7:{value:"Kiosks"},8:{value:a},9:{value:1},14:{value:30}}],{data:w}=await Q.fetchFromStructureApp({fields:C});if(w.length===0){u({type:"negative",message:"Valid Kiosk Account Required!",timeout:7e3,position:n.lt.md?"top":"top-right"}),i.value=!1;return}else V(w[0]),v.value.hide()}catch(e){i.value=!1;const{response:a}=e;a&&a.data.errtext&&a.data.errdetail?u({type:"negative",message:a.data.errdetail,timeout:7e3,position:n.lt.md?"top":"top-right"}):(console.log(e),u({type:"negative",message:"An error occurred, please try again later",timeout:7e3,position:n.lt.md?"top":"top-right"}))}};return(p,e)=>(B(),M($,L({persistent:""},p.$attrs,{ref_key:"dialog",ref:v,onSubmit:e[3]||(e[3]=P(()=>{},["prevent"])),onKeyup:S(y,["enter"])}),{default:t(()=>[s(E,{style:{"min-width":"350px"}},{default:t(()=>[s(c,null,{default:t(()=>[I]),_:1}),s(c,{class:"q-pt-none"},{default:t(()=>[s(q,{for:"email",style:{"padding-bottom":"0px"},autocomplete:"username",clearable:"",outlined:"",modelValue:l(r),"onUpdate:modelValue":e[0]||(e[0]=a=>_(r)?r.value=a:null),type:"email",label:"Email",tabindex:"1",error:!!l(f),"error-message":l(f)},{prepend:t(()=>[s(g,{name:"email"})]),_:1},8,["modelValue","error","error-message"])]),_:1}),s(c,{class:"q-pt-none"},{default:t(()=>[s(q,{for:"password",class:"q-mt-lg",outlined:"",modelValue:l(o),"onUpdate:modelValue":e[2]||(e[2]=a=>_(o)?o.value=a:null),type:d.value?"password":"text",label:"Password",autocomplete:"current-password",tabindex:"2",error:!!l(b),"error-message":l(b)},{append:t(()=>[s(g,{name:d.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[1]||(e[1]=a=>d.value=!d.value)},null,8,["name"])]),prepend:t(()=>[s(g,{name:"lock"})]),_:1},8,["modelValue","type","error","error-message"])]),_:1}),s(R,{align:"right",class:"text-primary"},{default:t(()=>[s(U,{label:"Login",color:"primary",onClick:y,loading:i.value,disabled:i.value},null,8,["loading","disabled"])]),_:1})]),_:1})]),_:1},16,["onKeyup"]))}};export{J as _};
