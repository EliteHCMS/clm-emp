import{_ as te,c_ as re,bT as ne,cW as ie,bU as de,c0 as ue,bL as ce,r as i,ac as Q,c2 as C,c4 as L,b8 as w,aT as E,g as u,ad as v,bd as o,h as R,al as s,ae as c,k as U,bO as P,c$ as me,Z as q,bA as pe,bz as ge,cy as H,ai as ve,bV as B,bW as z,n as fe,bX as he,ak as j,bQ as ye,aA as K,q as X}from"./index.a71f5d5e.js";import{Q as be}from"./QForm.6788df41.js";import{Q as we}from"./QPage.b5804b9e.js";import{p as _e}from"./VueTelInput.f8cd75ef.js";import{c as xe}from"./carousel.2dc4b3ca.js";import"./use-panel.d4f51200.js";import"./use-fullscreen.f03c57f7.js";const ke={name:"Login",components:{phoneNumberInput:_e,carousel:xe,languageSelector:re},setup(){const l=ne(),r=ie(),_=de(),{locale:e,t:x}=ue(),{currentUserType:k}=ce(),t=i(!1),n=i(!1),f=i(10),p=i(!1),d=i(null),M=i(!1),Y=i("first"),h=i("username"),O=i(null),I=i(null),T=i(!1),S=i(!1);r.query.redirect&&(I.value=r.query.redirect,_.replace({query:{}}));const G=Q(()=>t.value?C().email(`${x("validEmailIsRequired")}`).nullable():C().email(`${x("validEmailIsRequired")}`).nullable()),J=Q(()=>{if(n.value)return C().nullable();{const a=new RegExp("^[0-9]{"+f.value+"}","g");return C().matches(a,{excludeEmptyString:!0,message:`${x("validPhoneIsRequired")}`}).nullable()}}),$=Q(()=>C().required().matches(/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d@$!%*#?&]{8,}$/,{excludeEmptyString:!0,message:`${x("passwordRules")}`}).nullable()),{errorMessage:V,value:y}=L("email",G),{errorMessage:A,value:g}=L("phone",J),{errorMessage:Z,value:b}=L("password",$),ee=i(!0);w(V,a=>{a||y.value===""?n.value=!1:n.value=!0}),w(y,a=>{!a||a===""?n.value=!1:/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(a)&&!V.value&&(n.value=!0)}),w(A,a=>{a||g.value===""?t.value=!1:t.value=!0}),w(g,a=>{!a||a===""?t.value=!1:a.length===f.value&&!A.value&&(t.value=!0)}),w(Z,a=>{a||b.value===""?p.value=!1:p.value=!0}),w(b,a=>{M.value=!1,(!a||a==="")&&(p.value=!1)});const ae=a=>{f.value=a},D=Q(()=>!(t.value||n.value)),le=a=>{d.value=a},se=()=>{h.value="username",b.value=null,K(()=>{document.querySelector("#email").focus()})},oe=()=>{h.value="username",b.value=null,K(()=>{document.querySelector("#phoneNumber").focus()})},F=async()=>{S.value=!0;const a={userType:k};t.value?a.phoneNumber=`+${d.value?d.value.dialCode:"1"}${g.value}`:n.value&&(a.email=y.value);try{const m=await X.checkIfUserExist(a);S.value=!1,m?(h.value="password",K(()=>{document.querySelector("#password").focus()})):k==="Candidate"?_.push({name:"register",params:{...t.value&&{phoneTemp:g.value},...n.value&&{emailTemp:a.email}}}):l.dialog({title:"Alert",message:t.value?"That phone number does not exist. Try again.":"That email does not exist. Try again."}).onOk(()=>{g.value="",t.value=!1,y.value="",n.value=!1})}catch(m){S.value=!1,console.log(m)}},W=async()=>{T.value=!0,clearTimeout(O.value);const a={password:b.value,userType:k};t.value?a.phoneNumber=`+${d.value?d.value.dialCode:"1"}${g.value}`:n.value&&(a.email=y.value);try{const m=await X.login(a);T.value=!1,m&&(I.value?_.push(I.value):_.push({path:"/"}))}catch(m){T.value=!1,O.value=setTimeout(function(){M.value=!1},7e3);const{response:N}=m;N&&N.data.errtext&&N.data.errdetail?l.notify({type:"negative",message:N.data.errdetail,timeout:7e3,position:l.screen.lt.md?"top":"top-right"}):(console.log(m),l.notify({type:"negative",message:"An error occurred, please try again later",timeout:7e3,position:l.screen.lt.md?"top":"top-right"}))}};return{email:y,phone:g,password:b,isPwd:ee,validPhone:t,validEmail:n,step:h,validPassword:p,invalidLogin:M,continueProgress:S,loginProgress:T,passwordMessage:Z,phoneMessage:A,emailMessage:V,userNameInvalid:D,updatePhoneMaxLength:ae,continueAction:F,editUserNameEmail:se,editUserNamePhoneNumber:oe,slide:Y,login:W,updateCountry:le,onSubmit:a=>{h.value==="username"&&!D.value?F():h.value==="password"&&!(!p.value||M.value)?W():a.preventDefault()},locale:e,currentUserType:k}}},Ce={key:0,class:"col-md-7 col-lg-8 col-lx-8"},Pe={class:"col-xs-12 col-sm-12 col-md-5 col-lg-4 col-lx-4 row justify-center items-center"},qe={class:"text-dark"},Me={key:1,class:"divider"},Te={class:"divider-text"},Se={key:0,class:"text-grey-6",tabindex:"4"},Ne={class:"row justify-center"};function Qe(l,r,_,e,x,k){const t=E("carousel"),n=E("phone-number-input"),f=E("router-link"),p=E("languageSelector");return u(),v(we,{class:"window-height window-width row"},{default:o(()=>[l.$q.screen.lt.md?c("",!0):(u(),R("div",Ce,[s(t)])),U("div",Pe,[s(ye,{class:"auth-card",flat:""},{default:o(()=>[s(P,{style:{"padding-left":"30px","padding-right":"30px"}},{default:o(()=>[s(me,{src:"https://cdn.jsdelivr.net/gh/EliteHCMS/assets@latest/public/logo.svg",fit:"scale-down",class:"auth-logo full-width"})]),_:1}),s(P,{class:"text-center auth-description"},{default:o(()=>[U("p",qe,q(l.$t("pleaseSignInToYourAccount")),1)]),_:1}),s(P,null,{default:o(()=>[s(be,{class:"q-px-sm q-pt-sm",onSubmit:r[4]||(r[4]=pe(()=>{},["prevent"])),onKeyup:ge(e.onSubmit,["enter"])},{default:o(()=>[!e.validEmail&&!e.validPhone||e.validEmail?(u(),v(H,{key:0,for:"email",style:{"padding-bottom":"0px"},autocomplete:"username",clearable:"",outlined:"",modelValue:e.email,"onUpdate:modelValue":r[0]||(r[0]=d=>e.email=d),type:"email",label:l.$t("email"),tabindex:"1",error:!!e.emailMessage,"error-message":e.emailMessage,readonly:e.step!=="username"},ve({prepend:o(()=>[s(z,{name:"email"})]),_:2},[e.step!=="username"?{name:"append",fn:o(()=>[s(B,{round:"",dense:"",flat:"",icon:"edit",onClick:e.editUserNameEmail},null,8,["onClick"])])}:void 0]),1032,["modelValue","label","error","error-message","readonly"])):c("",!0),!e.validEmail&&!e.validPhone&&e.currentUserType!=="QuickBase User"?(u(),R("div",Me,[U("div",Te,q(l.$t("or")),1)])):c("",!0),(!e.validEmail&&!e.validPhone||e.validPhone)&&e.currentUserType!=="QuickBase User"?(u(),v(n,{key:2,outlined:"",for:"phoneNumber",modelValue:e.phone,"onUpdate:modelValue":r[1]||(r[1]=d=>e.phone=d),label:l.$t("phoneNumber"),tabindex:"1",autocomplete:"username",onMaxLengthChanged:e.updatePhoneMaxLength,style:fe(e.phoneMessage?"padding-bottom: 20px;":"padding-bottom: 0px;"),error:!!e.phoneMessage,"error-message":e.phoneMessage,readonly:e.step!=="username",editIcon:e.step!=="username",onEditClicked:e.editUserNamePhoneNumber,onCountryChanged:e.updateCountry},null,8,["modelValue","label","onMaxLengthChanged","style","error","error-message","readonly","editIcon","onEditClicked","onCountryChanged"])):c("",!0),e.step==="password"?(u(),v(H,{key:3,for:"password",class:"q-mt-lg",outlined:"",modelValue:e.password,"onUpdate:modelValue":r[3]||(r[3]=d=>e.password=d),type:e.isPwd?"password":"text",label:l.$t("password"),autocomplete:"current-password",tabindex:"2",error:!!e.passwordMessage,"error-message":e.passwordMessage},{append:o(()=>[s(z,{name:e.isPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:r[2]||(r[2]=d=>e.isPwd=!e.isPwd)},null,8,["name"])]),prepend:o(()=>[s(z,{name:"lock"})]),_:1},8,["modelValue","type","label","error","error-message"])):c("",!0)]),_:1},8,["onKeyup"])]),_:1}),s(he,{class:"q-px-lg"},{default:o(()=>[e.step==="username"?(u(),v(B,{key:0,loading:e.continueProgress,unelevated:"",size:"lg",color:"primary",class:"full-width text-white",label:l.$t("continue"),tabindex:"3",disabled:e.userNameInvalid,onClick:e.continueAction},null,8,["loading","label","disabled","onClick"])):c("",!0),e.step==="password"?(u(),v(B,{key:1,loading:e.loginProgress,unelevated:"",size:"lg",color:"primary",class:"full-width text-white",label:l.$t("login"),tabindex:"3",disabled:!e.validPassword||e.invalidLogin,onClick:e.login},null,8,["loading","label","disabled","onClick"])):c("",!0)]),_:1}),s(P,{class:"text-center q-pa-sm"},{default:o(()=>[e.currentUserType==="Candidate"?(u(),R("p",Se,[j(q(l.$t("needAnAccountQuestion"))+" ",1),s(f,{to:"/register",class:"text-grey-6"},{default:o(()=>[j(q(l.$t("register")),1)]),_:1})])):c("",!0),e.currentUserType!=="QuickBase User"?(u(),v(f,{key:1,to:"/forgot-password",class:"text-grey-6"},{default:o(()=>[j(q(l.$t("forgotPasswordQuestion")),1)]),_:1})):c("",!0)]),_:1}),s(P,{class:"q-pl-lg q-pa-sm"},{default:o(()=>[U("div",Ne,[s(p,{dense:"",borderless:""})])]),_:1})]),_:1})])]),_:1})}var ze=te(ke,[["render",Qe],["__scopeId","data-v-1814dc0e"]]);export{ze as default};
