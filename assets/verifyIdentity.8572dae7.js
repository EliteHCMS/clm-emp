import{_ as H,bJ as W,bN as z,bL as J,cW as Z,bU as G,c0 as K,r as x,ac as ee,c1 as ae,d6 as te,c2 as N,d4 as se,c3 as le,c4 as I,b8 as re,g as v,ad as b,bd as r,h as oe,al as l,ae as _,k as u,bO as g,c$ as ie,Z as $,bA as ne,cy as M,V as o,D as V,bW as U,bX as ue,bV as ce,c_ as de,bQ as me,q as n}from"./index.2d58de3a.js";import{Q as pe}from"./QForm.0e69daf8.js";import{Q as fe}from"./QPage.37fc11d1.js";import{c as ve}from"./carousel.05d59302.js";import"./use-panel.635e7b44.js";import"./use-fullscreen.fdaf91e7.js";const ge={key:0,class:"col-md-7 col-lg-8 col-lx-8"},ye={class:"col-xs-12 col-sm-12 col-md-5 col-lg-4 col-lx-4 row justify-center items-center"},he={class:"text-dark"},be={class:"row"},_e={class:"row"},we={class:"text-grey-6"},qe={class:"row justify-center"},xe={__name:"verifyIdentity",setup(Ie){const a=W(),{employeeData:k,socialRequired:C,updateEmployeeData:E,setEmployee:Q}=z(),L=J(),d=Z(),m=G(),{t:D}=K(),y=x(!1),w=x("confirm-identity"),j=ee(()=>ae({userRID:te().required(),ssn:N().required().matches(/^[0-9]{9}/g,{excludeEmptyString:!0,message:`${D("nineDigitsRequired")}`}).nullable(),ssnConfirmation:N().oneOf([se("ssn"),null],`${D("socialSecurityNumberMustMatch")}`).required().nullable()})),{errors:Ue,meta:O}=le({validationSchema:j,initialValues:{ssn:"",ssnConfirmation:""}}),{value:p}=I("userRID"),{value:i,errorMessage:R,meta:A}=I("ssn"),{value:f,errorMessage:S,meta:B}=I("ssnConfirmation"),h=x(!0);d.query.rid?(p.value=d.query.rid,i.value="",f.value="",m.replace({query:{}})):m.push("/"),re(()=>d.query,()=>{d.query.rid&&(p.value=d.query.rid,i.value="",f.value="",m.replace({query:{}}))});const X=async()=>{const e=n.getOfficeLocation(),t=[{20:{value:a.getUser[35]},22:{value:a.getUser[37]},109:{value:i.value},25:{value:a.getUser[9]?a.getUser[9].phoneNumber:a.getUser[8].replace(/[^0-9]/g,"")},28:{value:a.getUser[50]?"Yes":"No"},26:{value:a.getUser[6]},34:{value:a.getUser[49]?"Yes":"No"},16:{value:e?e.rid:""}}],{data:s}=await n.upsertRecordsXML({to:"bp3gb7ng2",fieldsToReturn:[500],data:t,formatObject:500}),c=s[0][500];return a.userLoggedIn&&Q(c,!0),c[3]},q=async e=>{const t=n.getOfficeLocation(),s={3:{value:e},20:{value:a.getUser[35]},22:{value:a.getUser[37]},109:{value:i.value},25:{value:a.getUser[9]?a.getUser[9].phoneNumber:a.getUser[8].replace(/[^0-9]/g,"")},28:{value:a.getUser[50]?"Yes":"No"},26:{value:a.getUser[6]},34:{value:a.getUser[49]?"Yes":"No"},...t&&{16:{value:t.rid}}};return(await E({fields:s}))[3]},F=async e=>{const t=[{3:{value:a.getUser[86]},16:{value:e}}],{data:s}=await n.upsertRecordsXML({to:"br26nivmr",fieldsToReturn:[76],data:t,formatObject:76});return n.setCheckInData(s[0][76]),s[3]},Y=async()=>{const t=[{8:{value:`{'188'.EX.'${i.value}'}AND{'509'.EX.'false'}`},7:{value:"Employees"},9:{value:12}}],{data:s}=await n.fetchFromHiringApp({fields:t});return s[0]?s[0][3]:null},P=async()=>{if(!p.value||p.value==="")return!1;y.value=!0;let e=await Y();const t=new Date,s={3:{value:Number(p.value)},26:{value:t}};C&&e?(await n.softDeleteEmployee(k[3]),await q(e)):C&&!e?e=await q(k[3]):e?await q(e):e||(e=await X()),L.checkedIn&&F(e),s[80]={value:e},s[85]={value:!1};try{await n.updateUserData({fields:s}),y.value=!1,m.push({path:"/",query:{verify:!0,...e&&{rid:e}}})}catch(c){y.value=!1,console.log(c)}},T=()=>{a.logout().then(()=>{m.replace({name:"login"})})};return(e,t)=>(v(),b(fe,{class:"window-height window-width row"},{default:r(()=>[e.$q.screen.lt.md?_("",!0):(v(),oe("div",ge,[l(ve)])),u("div",ye,[l(me,{class:"auth-card",flat:""},{default:r(()=>[l(g,{style:{"padding-left":"30px","padding-right":"30px"}},{default:r(()=>[l(ie,{src:"https://cdn.jsdelivr.net/gh/EliteHCMS/assets@latest/public/logo.svg",fit:"scale-down",class:"auth-logo full-width"})]),_:1}),l(g,{class:"text-center auth-description"},{default:r(()=>[u("p",he,$(e.$t("pleaseVerifyInfoToCompleteRegistration")),1)]),_:1}),l(g,null,{default:r(()=>[l(pe,{class:"q-px-sm q-pt-sm",onSubmit:t[3]||(t[3]=ne(()=>{},["prevent"]))},{default:r(()=>[u("div",be,[w.value==="confirm-identity"?(v(),b(M,{key:0,class:"col-xs-12",outlined:"",mask:"#########",modelValue:o(i),"onUpdate:modelValue":t[0]||(t[0]=s=>V(i)?i.value=s:null),maxlength:"9",minlength:"9",type:"password",label:e.$t("socialSecurityNumber"),tabindex:"1",error:!!(o(R)&&o(A).validated),"error-message":o(R)},{prepend:r(()=>[l(U,{name:"lock"})]),_:1},8,["modelValue","label","error","error-message"])):_("",!0)]),u("div",_e,[w.value==="confirm-identity"?(v(),b(M,{key:0,class:"col-xs-12",outlined:"",mask:"#########",modelValue:o(f),"onUpdate:modelValue":t[2]||(t[2]=s=>V(f)?f.value=s:null),maxlength:"9",minlength:"9",type:h.value?"password":"text",label:e.$t("confirmSSN"),tabindex:"2",error:!!(o(S)&&o(B).validated),"error-message":o(S)},{prepend:r(()=>[l(U,{name:"lock"})]),append:r(()=>[l(U,{name:h.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:t[1]||(t[1]=s=>h.value=!h.value)},null,8,["name"])]),_:1},8,["modelValue","type","label","error","error-message"])):_("",!0)])]),_:1})]),_:1}),l(ue,{class:"q-px-lg"},{default:r(()=>[w.value==="confirm-identity"?(v(),b(ce,{key:0,loading:y.value,disable:!o(O).valid,unelevated:"",size:"lg",color:"primary",class:"full-width text-white",label:e.$t("confirm"),tabindex:"3",onClick:P},null,8,["loading","disable","label"])):_("",!0)]),_:1}),l(g,{class:"text-center q-pa-sm"},{default:r(()=>[u("p",we,[u("a",{onClick:T,class:"text-grey-6",href:"javascript:void(0);",tabindex:"4"},$(e.$t("logout")),1)])]),_:1}),l(g,{class:"q-pl-lg q-pa-sm"},{default:r(()=>[u("div",qe,[l(de,{dense:"",borderless:""})])]),_:1})]),_:1})])]),_:1}))}};var $e=H(xe,[["__scopeId","data-v-0234fee0"]]);export{$e as default};
